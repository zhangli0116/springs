<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://cdn.bootcss.com/jquery/2.1.3/jquery.js"></script>
    <script src="https://cdn.bootcss.com/sockjs-client/1.3.0/sockjs.js"></script>
    <script src="https://cdn.bootcss.com/stomp.js/2.3.3/stomp.js"></script>
    <script>
        //var url = "http://192.168.56.132:15674/stomp";
        //var ws = new SockJS(url);  //这种无法连接？
        var ws = new WebSocket("ws://192.168.56.132:15674/ws");
        var client = Stomp.over(ws);
        //建立连接
        client.connect('admin','123456',function(message){
            console.log(message.body);
            //订阅
            // 规则  rabbitmq 名为default的队列
           client.subscribe('/queue/default',function(data){
                console.log("接收到数据："+ data.body);
            })
        })
        //发送数据
        function sendName(){
            client.send('/queue/simple',{},"send to server");
        }
        //关闭连接
        function disconnect(){
            if(client){
                client.disconnect();
            }
        }

        $(function(){
            $('#sender').on('click',function () {
                sendName();
            })
            $('#close').click(function () {
                disconnect();
            });
            $('#receiver').on('click',function () {
                $.post('/webSocket/sendToClient',function (data) {
                    console.log(data);
                });
            })

        })

    </script>
</head>
<body>
<input type="button" id="sender" value="发送数据给后台" />
<input type="button" id="receiver" value="接受后台" />
<input type="button" id="close" value="关闭websocket"/>
</body>
</html>