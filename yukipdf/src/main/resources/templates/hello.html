<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://cdn.bootcss.com/jquery/2.1.2/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <!-- 可选的 Bootstrap 主题文件（一般不用引入） -->
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

</head>
<body>
<div  style="margin-top: 50px;margin-left: auto;margin-right: auto">
    <div style="margin-left: auto;margin-right:auto;padding: 30px;width: 400px;height: 250px;border:1px solid black">
        <form action=""  enctype="multipart/form-data" class="form-inline" role="form">
            <input type="file" id="file" style="display:none">
            <div class="radio">
                <label>
                    <input type="radio" name="element" id="odd" value="1" checked> 奇数页
                </label>
            </div>
            <div class="radio">
                <label>
                    <input type="radio" name="element" id="even" value="0"> 偶数
                </label>
            </div>
            <div class="form-group">
                <input type="text" class="form-control" id="txt" placeholder="选择文件"/>
                <input type="button" id="importExcel" class="btn"  value="Submit"/>
            </div>
        </form>
    </div>

    <iframe id="iframeFile" style="display:none"></iframe>
</div>
</body>
<script>
    $(function(){
        $('#file').on('change',function(){
            var file = document.getElementById('file').files[0];
            if(file){
                var fileName = file.name;
                $('#txt').val(fileName);
            }
        })

        /**
         * 文本框联动file
         */
        $('#txt').click(function(){
            $(this).val('');
            $('#file').click();
        })

        $('#importExcel').on('click',function(){
             var file = document.getElementById('file').files[0];
             var element = $('input[type="radio"]:checked').val();
             if(file){
                 var formData = new FormData();
                 formData.append("multipartFile",file);
                 formData.append("element",element);
                 var oReq  = new XMLHttpRequest();
                 oReq.open("POST", "/importExcel",true);
                 oReq.responseType = 'blob';
                 oReq.onload = function(e){
                     if(oReq.status == 200){
                         var blob = oReq.response;
                         var url = window.URL.createObjectURL(blob);
                         var a = document.createElement('a');
                         a.href = url;
                         a.target="_blank";
                         a.download = element==1 ?file.name.split(/\./)[0]+"(奇数页).pdf" : file.name.split(/\./)[0]+"(偶数页).pdf";//html5新属性 表示这是一个下载链接而不是普通链接,同时可以指定文件名字
                         a.click();
                     }
                 }
                 oReq.send(formData);
             }
        })



    })

</script>
</html>